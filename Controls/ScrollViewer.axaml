<ResourceDictionary
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  x:ClassModifier="internal">

  <Design.PreviewWith>
    <ScrollViewer Width="200" Height="200"
                  HorizontalScrollBarVisibility="Auto"
                  VerticalScrollBarVisibility="Auto">
      <StackPanel Spacing="20" Width="210">
        <TextBlock>Item 1</TextBlock>
        <TextBlock>Item 2</TextBlock>
        <TextBlock>Item 3</TextBlock>
        <TextBlock>Item 4</TextBlock>
        <TextBlock>Item 5</TextBlock>
        <TextBlock>Item 6</TextBlock>
        <TextBlock>Item 7</TextBlock>
        <TextBlock>Item 8</TextBlock>
        <TextBlock>Item 9</TextBlock>
      </StackPanel>
    </ScrollViewer>
  </Design.PreviewWith>

  <ControlTheme x:Key="{x:Type ScrollViewer}" TargetType="ScrollViewer">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="Template">
      <ControlTemplate>
        <Grid>
          <!-- El contenido ahora ocupa TODO -->
          <ScrollContentPresenter Name="PART_ContentPresenter"
                                  Background="{TemplateBinding Background}"
                                  HorizontalSnapPointsType="{TemplateBinding HorizontalSnapPointsType}"
                                  VerticalSnapPointsType="{TemplateBinding VerticalSnapPointsType}"
                                  HorizontalSnapPointsAlignment="{TemplateBinding HorizontalSnapPointsAlignment}"
                                  VerticalSnapPointsAlignment="{TemplateBinding VerticalSnapPointsAlignment}"
                                  Padding="{TemplateBinding Padding}"
                                  ScrollViewer.IsScrollInertiaEnabled="{TemplateBinding IsScrollInertiaEnabled}">
            <ScrollContentPresenter.GestureRecognizers>
              <ScrollGestureRecognizer CanHorizontallyScroll="{Binding CanHorizontallyScroll, ElementName=PART_ContentPresenter}"
                                       CanVerticallyScroll="{Binding CanVerticallyScroll, ElementName=PART_ContentPresenter}"
                                       IsScrollInertiaEnabled="{Binding (ScrollViewer.IsScrollInertiaEnabled), ElementName=PART_ContentPresenter}"/>
            </ScrollContentPresenter.GestureRecognizers>
          </ScrollContentPresenter>

          <!-- Barras flotando sobre el contenido -->
          <ScrollBar Name="PART_HorizontalScrollBar"
                     Orientation="Horizontal"
                     VerticalAlignment="Bottom"
                     HorizontalAlignment="Stretch"
                     Margin="0"/>
          <ScrollBar Name="PART_VerticalScrollBar"
                     Orientation="Vertical"
                     HorizontalAlignment="Right"
                     VerticalAlignment="Stretch"
                     Margin="0"/>
        </Grid>
      </ControlTemplate>
    </Setter>

    <!-- Si AllowAutoHide=True, el contenido sigue ocupando todo -->
    <Style Selector="^[AllowAutoHide=True] /template/ ScrollContentPresenter#PART_ContentPresenter">
      <Setter Property="Grid.ColumnSpan" Value="1" />
      <Setter Property="Grid.RowSpan" Value="1" />
    </Style>
  </ControlTheme>
</ResourceDictionary>
